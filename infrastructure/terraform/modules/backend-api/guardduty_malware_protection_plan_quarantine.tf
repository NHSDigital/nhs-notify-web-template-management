resource "aws_guardduty_malware_protection_plan" "quarantine" {
  depends_on = [
    aws_iam_role_policy_attachment.guardduty_quarantine
  ]

  role = aws_iam_role.guardduty_quarantine.arn

  protected_resource {
    s3_bucket {
      bucket_name     = module.s3bucket_quarantine.id
      object_prefixes = ["docx-template/", "pdf-template/", "test-data/", "proofs/"]
    }
  }

  actions {
    tagging {
      status = "ENABLED"
    }
  }
}
